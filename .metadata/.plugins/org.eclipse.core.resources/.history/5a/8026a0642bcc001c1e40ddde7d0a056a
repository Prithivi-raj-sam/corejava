package com.chainsys.jdbcBasic;

import java.io.File;
import java.io.FileReader;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.SQLException;

public class JDBC1 {
	public static void main(String[] args) {
		JDBC1 j=new JDBC1();
		j.insert();
//		j.update();
	}
	public void insert() {
	      try {
	    	  System.out.println("enter the password:");
	          Class.forName("oracle.jdbc.driver.OracleDriver");
	          java.util.Scanner sc=new java.util.Scanner(System.in);
	          String password =sc.next();
	          sc.close();
	          Connection myCon1 = DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521:xe","system",password);
	          PreparedStatement ps = myCon1.prepareStatement("insert into ? values(?,?,?,?)");
	          File f = new File("d:\\ass\\record.txt");
	          FileReader fr = new FileReader(f);
	          ps.setString(1, "FileTable");
	          ps.setInt(2, 101);
	          ps.setCharacterStream(3, fr,(int)f.length());
//	          ps.setString(2, "samprithivi1");
	          ps.setInt(4, 99);
	          ps.setDouble(5, 81.97);
	          int i = ps.executeUpdate();
	          System.out.println(i+" "+"record inserted");
	          myCon1.close();
	          fr.close();
	      }catch(Exception err) {
	          err.printStackTrace();
	      }
	}
	public void update()  {
		System.out.println("enter the password:");
       try {
        java.util.Scanner sc=new java.util.Scanner(System.in);
        String password =sc.next();
        sc.close();
        Connection myCon1 = DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521:xe","system",password);
        PreparedStatement ps = myCon1.prepareStatement("update FileTable set ?=? where id=?");
        ps.setString(1,"mark");
        ps.setDouble(2, 95.8);
        ps.setInt(3, 105);
        int i=ps.executeUpdate();
		System.out.println(i+" record updated");
		myCon1.close();
       }catch(SQLException se) {
    	   se.printStackTrace();
       }
		
	}
	public void delete() {
		
	}


}
